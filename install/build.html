
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Building Source Code &#8212; Avogadro 1.93.1-145-g333a47ae documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="https://two.avogadro.cc/install/build.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Script Plugins" href="../scripts/index.html" />
    <link rel="prev" title="Install" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/avogadro2.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../scripts/index.html">
  Script Plugins
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/index.html">
  Library API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../contrib/index.html">
  Contribute
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://discuss.avogadro.cc">Discuss<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/openchemistry/avogadrolibs" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/AvogadroChem" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Building Source Code
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cloning-repositories">
   Cloning Repositories
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating">
   Updating
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prerequisites">
   Prerequisites
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building">
   Building
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-qt-windows-generators">
     Finding Qt, Windows Generators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normal-development">
     Normal Development
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-tree-layout">
   Build Tree Layout
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#running-executables">
     Running Executables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-packages">
     Building Packages
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/openchemistry/avogadrolibs/edit/master/docs/install/build.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          
          

          
          
            
            
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
            
              <div>
                
  <div class="section" id="building-source-code">
<span id="build"></span><h1>Building Source Code<a class="headerlink" href="#building-source-code" title="Permalink to this headline">¶</a></h1>
<p>The Open Chemistry project uses Git for version control, and CMake to
direct the build process. The <a class="reference external" href="https://github.com/OpenChemistry/openchemistry">openchemistry
repository</a> contains
git submodules with other actively developed projects such as
<a class="reference external" href="Avogadro">Avogadro</a>, and
<a class="reference external" href="MoleQueue">MoleQueue</a>. It will also automatically download source
tarballs and build them for third party dependencies, with variables
named USE_SYSTEM_LIBRARY to attempt to find and build against system
versions.</p>
<p>This page goes through the steps of building the Open Chemistry projects
using the openchemistry git repository. It is entirely possible to build
each project individually without using the “superbuild” approach, but
you will need to ensure all dependencies are built and can be found by
the project.</p>
<p>Once successfully built you will be left with several build
directories which you can treat as normal build directories, developing
and compiling from inside them largely ignoring the outer build tree.</p>
<div class="section" id="cloning-repositories">
<span id="id1"></span><h2>Cloning Repositories<a class="headerlink" href="#cloning-repositories" title="Permalink to this headline">¶</a></h2>
<p>You should clone the repositories from our source code hosting
infrastructure, or the Github/Gitorious mirror. You should also track
changes from here as the cloning/update process will be faster, and is
always in sync with Gerrit. To clone the Open Chemistry repository that
contains the other projects as submodules,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git clone --recursive git://github.com/OpenChemistry/openchemistry.git
</pre></div>
</div>
</div>
<div class="section" id="updating">
<h2>Updating<a class="headerlink" href="#updating" title="Permalink to this headline">¶</a></h2>
<p>In order to update the repository from the openchemistry module you can
run,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git pull
git submodule update --init
</pre></div>
</div>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>The Open Chemistry projects have a number of prerequisites, and these
vary by platform. On Windows Visual Studio 2017 is best supported. The
superbuild will attempt to build a number of dependencies, on Linux you
are likely best off installing these with your package manager, and on
macOS the homebrew package manager works well.</p>
<p>We should add a package listing for various Linux distributions, but as
a guide you will need:</p>
<ul class="simple">
<li><p>a C/C++ compiler that supports C++11</p></li>
<li><p>OpenGL</p></li>
<li><p>Qt 5.6+</p></li>
<li><p>CMake 3.3+</p></li>
<li><p>Python</p></li>
</ul>
</div>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>It is recommended that you create a build tree outside of the source
tree. Assuming you are in the directory where you cloned the repository
the following commands will create a build tree, configure it and build.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mkdir openchemistry-build
<span class="nb">cd</span> openchemistry-build
cmake ../openchemistry
cmake --build . --config Release
</pre></div>
</div>
<p>You may wish to run cmake-gui in the build directory once it has been
configured. You can build against system libraries to avoid building
them (examples include Boost, Eigen, etc), and turn testing on globally
(ENABLE_TESTS) if you would like to ensure all tests are configured and
built for sub-projects. The –config argument to cmake –build is only
used on the Windows platform with MSVC, and can be removed elsewhere.</p>
<div class="section" id="finding-qt-windows-generators">
<span id="id2"></span><h3>Finding Qt, Windows Generators<a class="headerlink" href="#finding-qt-windows-generators" title="Permalink to this headline">¶</a></h3>
<p>We go to great care to use Qt5_DIR as the base for all Qt 5 modules, so
setting the correct Qt5_DIR should result in a valid tree, you can also
use CMAKE_PREFIX_PATH to point at the install prefix of Qt. When setting
Qt5_DIR for Windows, using Qt 5.10.1 as an example, you should set the
variable to ‘C:/Qt/Qt5.10.1/5.10.1/msvc2017_64/lib/cmake/Qt5’ (without
the quotes). As you upgrade, you can usually just replace the version
(that occurs twice), you must also be careful to match the CMake
generator to the compiler and architecture on Windows, I recommend
‘Visual Studio 15 2017 Win64’, we no longer build/test 32 bit binaries
on any platform.</p>
</div>
<div class="section" id="normal-development">
<span id="id3"></span><h3>Normal Development<a class="headerlink" href="#normal-development" title="Permalink to this headline">¶</a></h3>
<p>You can also open the top-level CMakeLists.txt in Qt Creator, choose the
build location, have that configure and build and then open the
top-level CMakeLists.txt for each of the sub-projects. When setting the
build location choose the openchemistry-build/avogadrolibs for Avogadro,
openchemistry-build/molequeue for MoleQueue, etc. Once you have compiled
the top-level, for normal day-to-day development you are free to ignore
it and perform the majority of work in the project being developed.</p>
</div>
</div>
<div class="section" id="build-tree-layout">
<span id="id4"></span><h2>Build Tree Layout<a class="headerlink" href="#build-tree-layout" title="Permalink to this headline">¶</a></h2>
<p>The build tree mirrors the source tree for most active projects. So
avogadrolibs is in the same relative path in the source and build trees.
For things such as Boost which are built from a source tarball they can
be found only in the build tree, and are under thirdparty/boost-prefix,
these projects are dependencies but are not expected to be edited in
place.</p>
<p>There is a prefix directory in the base of the build tree. This acts as
an install prefix for all projects, with the normal include, bin, share
and lib directories. This can be used to inject an additional prefix in
CMAKE_PREFIX_PATH to ensure projects build by the superbuild are found.
It keeps the sub-projects relatively simple as they either find stuff in
the prefix, or normal system paths.</p>
<div class="section" id="running-executables">
<span id="id5"></span><h3>Running Executables<a class="headerlink" href="#running-executables" title="Permalink to this headline">¶</a></h3>
<p>It is recommended that you run the binaries from within the prefix
directory in the build tree. The top-level targets (avogadroapp,
molequeue, monogochem) all install to the prefix, if running make from
within the individual build trees run make install to ensure you are
using the latest version. On Linux and Windows running Avogadro 2 looks
like,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>./openchemistry-build/prefix/bin/avogadro2
</pre></div>
</div>
<p>On Mac, it might be:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">DYLD_LIBRARY_PATH</span><span class="o">=</span>/Users/your-user/openchemistry-build/prefix/lib
open /Users/your-user/openchemistry-build/avogadroapp/bin/Avogadro2.app
</pre></div>
</div>
<p>We will look into improving this situation soon.</p>
</div>
<div class="section" id="building-packages">
<span id="id6"></span><h3>Building Packages<a class="headerlink" href="#building-packages" title="Permalink to this headline">¶</a></h3>
<p>The molequeue and avogadroapps projects can build installers.
In order to do this you must cd into the appropriate subdirectory and
call make package. So to build the Avogadro 2 package,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> avogadroapp
make package
</pre></div>
</div>
<p>You may need to run cmake-gui, toggle advanced variables and
enable/disable packages you are interested in. They are prefixed by
CPACK, and can be toggled before calling make package. A binary
installer will be created in the build directory.</p>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Install</a>
    <a class='right-next' id="next-link" href="../scripts/index.html" title="next page">Script Plugins</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="container-fluid footer-copy">

    <div class="container">

      <div class="row">
        <div class="col-md-10 py-2">
          <p>
            ©2021 The OpenChemistry / Avogadro Teams. The website content uses the <a href="https://github.com/openchemistry/avogadrolibs/blob/master/LICENSE">BSD License</a> and is covered by the <a href="https://github.com/openchemistry/avogadrolibs/blob/master/CODE_OF_CONDUCT.md">Avogadro Code of Conduct</a>.
          </p>
        </div>
        <br />
        <div class="col-md-2 py-2">
          <a class="btn btn-primary" href="https://opencollective.com/open-chemistry">Donate</a>
        </div>
      </div>

    </div>

  </footer>
  </body>
</html>